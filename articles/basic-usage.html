<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="opendatascotland">
<title>Basic Example • opendatascotland</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Basic Example">
<meta property="og:description" content="opendatascotland">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">opendatascotland</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-docs">Docs</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-docs">
    <a class="dropdown-item" href="../articles/basic-usage.html">Basic Examples</a>
    <a class="dropdown-item" href="../articles/riding-a-bike.html">Worked Example</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Basic Example</h1>
            
      
      
      <div class="d-none name"><code>basic-usage.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="intro">Intro<a class="anchor" aria-label="anchor" href="#intro"></a>
</h2>
<p>A good place to start is by browsing datasets on <a href="https://opendata.scot/" class="external-link">opendata.scot</a>. You can filter and
search to find datasets of interests. The <code>openscotland</code> R
package can then download and save the datasets you are interested in.
This helps to quickly start analysis without needing to work out how to
save, organise and import data in R.</p>
</div>
<div class="section level2">
<h2 id="search">Search<a class="anchor" aria-label="anchor" href="#search"></a>
</h2>
<p>The <code>opendatascotland</code> package has a basic search function
for finding available datasets and viewing their metadata. Use
<code>ods_search()</code> function to view metadata for all datasets or
filter by matching search terms in the dataset’s title.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fozy81.github.io/opendatascot/">opendatascotland</a></span><span class="op">)</span></span>
<span><span class="co"># View all available datasets and associated metadata</span></span>
<span><span class="va">all_datasets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/search_ods.html">search_ods</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Search dataset titles containing matching terms (case insensitive)</span></span>
<span><span class="va">single_query</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/search_ods.html">search_ods</a></span><span class="op">(</span><span class="st">"Number of bikes"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Search multiple terms</span></span>
<span><span class="va">multi_query</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/search_ods.html">search_ods</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Bins"</span>, <span class="st">"Number of bikes"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">multi_query</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 11</span></span></span>
<span><span class="co">#&gt;   unique_id            title organization notes category url   resources licence</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Salt_Bins_Dumfries_… Salt… Dumfries an… <span style="color: #949494;">"</span>&lt;p&gt;… <span style="color: #949494;">&lt;chr&gt;</span>    /dat… <span style="color: #949494;">&lt;df&gt;</span>      UK Ope…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Public_Litter_Bins_… Publ… Dundee City… <span style="color: #949494;">"</span>&lt;p&gt;… <span style="color: #949494;">&lt;chr&gt;</span>    /dat… <span style="color: #949494;">&lt;df&gt;</span>      UK Ope…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Solar_Powered_Compa… Sola… Dundee City… <span style="color: #949494;">"</span>&lt;p&gt;… <span style="color: #949494;">&lt;chr&gt;</span>    /dat… <span style="color: #949494;">&lt;df&gt;</span>      Open D…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Number_of_bikes_ava… Numb… Cycling Sco… <span style="color: #949494;">"</span>&lt;p&gt;… <span style="color: #949494;">&lt;chr&gt;</span>    /dat… <span style="color: #949494;">&lt;df&gt;</span>      UK Ope…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Number_of_bikes_ava… Numb… Cycling Sco… <span style="color: #949494;">"</span>&lt;p&gt;… <span style="color: #949494;">&lt;chr&gt;</span>    /dat… <span style="color: #949494;">&lt;df&gt;</span>      UK Ope…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Number_of_bikes_ava… Numb… Cycling Sco… <span style="color: #949494;">"</span>&lt;p&gt;… <span style="color: #949494;">&lt;chr&gt;</span>    /dat… <span style="color: #949494;">&lt;df&gt;</span>      Creati…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 3 more variables: date_created &lt;chr&gt;, date_updated &lt;chr&gt;, org_type &lt;chr&gt;</span></span></span></code></pre></div>
<p>Note, search term is case-insensitive but word order must be correct
(there is no ‘fuzzy’ matching).</p>
</div>
<div class="section level2">
<h2 id="download">Download<a class="anchor" aria-label="anchor" href="#download"></a>
</h2>
<p>Currently, only datasets available in <code>.csv</code>,
<code>json</code> or <code>.geojson</code> can be downloaded. These
formats cover the majority of data available. You will be warned if a
dataset can’t be downloaded.</p>
<p>To download data, you can either download the metadata using
<code><a href="../reference/search_ods.html">search_ods()</a></code>, then pass that data frame to
<code><a href="../reference/get_ods.html">get_ods()</a></code></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">query</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/search_ods.html">search_ods</a></span><span class="op">(</span><span class="st">"bins"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Warning: One or more parsing issues, call `problems()` on your data frame for details,</span></span>
<span><span class="co">#&gt; e.g.:</span></span>
<span><span class="co">#&gt;   dat &lt;- vroom(...)</span></span>
<span><span class="co">#&gt;   problems(dat)</span></span></code></pre>
<pre class="{r"><code><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ods.html">get_ods</a></span><span class="op">(</span><span class="va">query</span><span class="op">)</span></span></code></pre>
<p><strong><em>Or</em></strong> use the search argument in
<code>get_ods(search="my search term")</code> to search and download any
matching datasets in one step.</p>
<pre class="{r"><code><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ods.html">get_ods</a></span><span class="op">(</span>search <span class="op">=</span> <span class="st">"Grit bins"</span><span class="op">)</span></span></code></pre>
<p>By default, you will be asked if you want to save the data locally on
the first download. Optionally, you can refresh the data or avoid being
asked to save data.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ods.html">get_ods</a></span><span class="op">(</span>search <span class="op">=</span> <span class="st">"Number of bikes"</span>, refresh <span class="op">=</span> <span class="cn">TRUE</span>, ask <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plot">Plot<a class="anchor" aria-label="anchor" href="#plot"></a>
</h2>
<p>Once you have downloaded the dataset(s), you may wish to plot or map
the data. Here’s a short example of how plotting can be done.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ods.html">get_ods</a></span><span class="op">(</span>search <span class="op">=</span> <span class="st">"Recycling Point Locations"</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="../reference/get_ods.html">get_ods()</a></code> function returned a named list of data
frames - lets select the one we want by name:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">recycling_points</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">Recycling_Point_Locations_Dundee_City_Council</span></span></code></pre></div>
<p>Or alternatively select the first data frame in the list using index
of 1.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">recycling_points</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>Geojson datasets are automating converted to <a href="https://r-spatial.github.io/sf/" class="external-link">simple feature</a> ‘sf’ data. As
we can see in the example the data frame is classed as “sf” which means
spatial / geometry attributes are baked in.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">recycling_points</span><span class="op">)</span> </span>
<span><span class="co">#&gt; [1] "sf"         "data.frame"</span></span></code></pre></div>
<p>You can see a <code>geometry</code> variable which contains the
spatial co-ordinates. This allows the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function to
automatically plot the coordinates.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">recycling_points</span><span class="op">$</span><span class="va">geometry</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">recycling_points</span><span class="op">$</span><span class="va">LOCATION</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="basic-usage_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="section level3">
<h3 id="json">JSON<a class="anchor" aria-label="anchor" href="#json"></a>
</h3>
<p>Some data is only available in JSON or CSV formats which does not
automatically have spatial geometry. For example, the Glasgow cycling
counts does have <code>latitude</code> and <code>longitude</code>
variables but is downloaded as JSON and therefore does not have spatial
geometry added by default. This type of data is converted to a data
frame.</p>
<p>Let’s download the Glasgow cycle counts data which is only available
in JSON format.</p>
<pre class="{r"><code><span><span class="va">cycle_count</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ods.html">get_ods</a></span><span class="op">(</span>search <span class="op">=</span> <span class="st">"lasgow City Council - Daily cycling counts from automatic cycling counters"</span><span class="op">)</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cycle_count</span> <span class="op">&lt;-</span> <span class="va">cycle_count</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">cycle_count</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,000 × 10</span></span></span>
<span><span class="co">#&gt;    provider     area  siteID location latitude longitude startTime endTime count</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Glasgow Cit… Glas… GLG04… Bisland…     55.9     -<span style="color: #BB0000;">4.28</span> 2023-04-… 2023-0…    33</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Glasgow Cit… Glas… GLG03… London …     55.8     -<span style="color: #BB0000;">4.22</span> 2023-04-… 2023-0…   119</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Glasgow Cit… Glas… GLG03… Hawthor…     55.9     -<span style="color: #BB0000;">4.24</span> 2023-04-… 2023-0…    41</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Glasgow Cit… Glas… GLG03… CP St A…     55.8     -<span style="color: #BB0000;">4.29</span> 2023-04-… 2023-0…   253</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Glasgow Cit… Glas… GLG03… Pollok …     55.8     -<span style="color: #BB0000;">4.30</span> 2023-04-… 2023-0…   146</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Glasgow Cit… Glas… GLG03… Glasgow…     55.9     -<span style="color: #BB0000;">4.25</span> 2023-04-… 2023-0…     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Glasgow Cit… Glas… GLG03… Barrhea…     55.8     -<span style="color: #BB0000;">4.32</span> 2023-04-… 2023-0…    94</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Glasgow Cit… Glas… GLG03… Balshag…     55.9     -<span style="color: #BB0000;">4.33</span> 2023-04-… 2023-0…   174</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Glasgow Cit… Glas… GLG02… Balshag…     55.9     -<span style="color: #BB0000;">4.33</span> 2023-04-… 2023-0…    98</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Glasgow Cit… Glas… GLG02… CP Gars…     55.9     -<span style="color: #BB0000;">4.26</span> 2023-04-… 2023-0…  <span style="text-decoration: underline;">1</span>510</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 990 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: usmart_id &lt;chr&gt;</span></span></span></code></pre></div>
<p>We can see the cycle count JSON has been converted into a ‘flat’
tabulated data frame. This data frame can now be plotted as a chart, in
the following example, let’s use the <code>ggplot2</code> plotting
library to create a graph. We’ll display counts over time for each
location.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co"># Convert character to date (to display date time correctly) </span></span>
<span><span class="va">cycle_count</span><span class="op">$</span><span class="va">Date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">cycle_count</span><span class="op">$</span><span class="va">startTime</span><span class="op">)</span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">cycle_count</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Date</span>, y <span class="op">=</span> <span class="va">count</span>, colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">location</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="basic-usage_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>This is a bit noisy so lets sum the counts for all locations to see
total cycle counts.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Group by date and sum the count</span></span>
<span><span class="va">sum_cycle_count</span> <span class="op">&lt;-</span> <span class="va">cycle_count</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Date</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>`Total Count` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#  Graph the new `sum_count` variable</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sum_cycle_count</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Date</span>, y <span class="op">=</span> <span class="va">`Total Count`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="basic-usage_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>We can also use the latitude and longitude columns to plot the points
on a map.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE</span></span>
<span><span class="co"># Convert data frame into 'sf' geospatial dataframe</span></span>
<span><span class="va">cycle_counts_geo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">cycle_count</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"longitude"</span>, <span class="st">"latitude"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Sum counts by location</span></span>
<span><span class="va">cycle_counts_geo_sum</span> <span class="op">&lt;-</span> <span class="va">cycle_counts_geo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">location</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>`Total Cycle Count` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># plot</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">cycle_counts_geo_sum</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">`Total Cycle Count`</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"blue"</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">c</span></span></code></pre></div>
<p><img src="basic-usage_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>Can you guess which points in Glasgow are most popular for cyclists?
We can add a base layer map to reveal the streets.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dkahle/ggmap" class="external-link">ggmap</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create bounding box to download background street map layer</span></span>
<span><span class="va">bbox_glasgow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="va">cycle_counts_geo_sum</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bbox_glasgow</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"bottom"</span>, <span class="st">"right"</span>, <span class="st">"top"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Download background layer</span></span>
<span><span class="va">glasgow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggmap/man/ggmap.html" class="external-link">ggmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggmap/man/get_stamenmap.html" class="external-link">get_stamenmap</a></span><span class="op">(</span><span class="va">bbox_glasgow</span>, zoom <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot background with cycle counts on top</span></span>
<span><span class="va">cycle_map</span> <span class="op">&lt;-</span> <span class="va">glasgow</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cycle_counts_geo_sum</span>,</span>
<span>                                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>                                x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">geometry</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">geometry</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                size <span class="op">=</span> <span class="va">`Total Cycle Count`</span><span class="op">)</span>,</span>
<span>                                col<span class="op">=</span><span class="st">"green"</span>, </span>
<span>                                pch<span class="op">=</span><span class="fl">16</span>, </span>
<span>                                alpha<span class="op">=</span><span class="fl">0.4</span></span>
<span>                          <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span></span>
<span><span class="va">cycle_map</span> </span>
<span><span class="co">#&gt; Warning: Removed 1 rows containing missing values (`geom_point()`).</span></span></code></pre></div>
<p><img src="basic-usage_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>Looks like <a href="https://www.openstreetmap.org/#map=16/55.8530/-4.2606" class="external-link">Tradeston</a>
area is a hot spot for cyclists.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Tim Foster.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
